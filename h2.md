# h2

### x) 

### Broken access control

Broken access control refers to an attack, that abuses a failure in access control, a policy that is designed 
to limit user control of unauthorized users. This can lead to data compromisation and misuse by attackers.

### Fuzz URLs with ffuf

ffuf is a tool written by Joona 'joohoi' Hoikkala, which is used to find hidden web-page directories. Tero's guide does a
tour of the tool and shows you what and how! This can be used for broken access tool testing. 

### PortSwigger: Access control vulnerabilities and privilege escalation

This PortSwigger article covers privilege escalataion, vulnerability types and the methods of preventing such vulrenabilities.
Some key points from the article:

#### Access control
- Authentication for user confirmation
- Session management id's HTTP requests to assess user
- Access contol decides if user has sufficient rights for action
#### Vertical access controls
- Vertical access controls categorize user types and assign function-specific rights i.e admin, user.
#### Horizontal access controls
- Horizontal access controls are used to restrict the information a user gets from provider.
#### Context-dependent access controls
- Context-depended access controls uses both Horizontal- and Vertical access controls to limit both function- and resource rights.

### Karvinen 2006: Report Writing (in Finnish)

This is a guide written by Tero, which covers the how-to on report-writing when testing something on a system.



### a) Break into 010-staff-only

<img width="963" height="1004" alt="image" src="https://github.com/user-attachments/assets/e5fc7680-b663-4473-8cc2-959d47cf8f73" />

### b) Fix the 010-staff-only vulnerability from source code. Demonstrate with a test that your solution works.
<img width="750" height="570" alt="image" src="https://github.com/user-attachments/assets/4bb58f5d-41b4-4c03-bb1f-e4eba09778f1" />

Modified the SQL line so that the pin is the correct data and not a string variable.

<img width="1000" height="1088" alt="image" src="https://github.com/user-attachments/assets/6f17aefe-6f9f-48ba-a18f-3e6e771f8d81" />

Correctly prints input data as blank! Injections not coming through :)

### c) 

<img width="1920" height="1080" alt="image" src="https://github.com/user-attachments/assets/24e58081-cb05-473c-818a-6705c425ddbd" />

Did the dirfuzt-0 and dirfuzt-1, just had to change the filesize sort on the dirfuzt-1 :)

### d) 

Fiddled around on the site for a while and made an account. I tried fuzzing the site for hidden directories and found admin-console. Worked! This was misconfigured vertical access control!

<img width="1920" height="1080" alt="image" src="https://github.com/user-attachments/assets/3906a0b8-cd3f-4d64-aa1b-4f44b4d60eea" />

### e)
Had a huge headache trying to find the permissions and found them by using Tero's tip. Then I got stuck with actually writing the code to fix it. After the headache turned into a minor migraine I checked out the provided walkthrough and found the fix:

<img width="1000" height="1088" alt="image" src="https://github.com/user-attachments/assets/7c1bf53c-b3ce-49af-979d-d48da575c03f" />

<img width="750" height="587" alt="image" src="https://github.com/user-attachments/assets/f6b0e5a9-73f2-4177-8d59-f4ada271517d" />

A lot of hair-pulling indeed. Nice exercises. Get you interested to learn more!

All sources that were used are provided @ https://terokarvinen.com/application-hacking/






















